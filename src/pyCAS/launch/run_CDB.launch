<?xml version="1.0" ?>
<launch>
  <!-- arguments -->
  <arg name="map_file" default="$(find pyCAS)/domains/CDB/maps/campus_1.yaml" />
  <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
  <arg name="move_forward_only" default="false"/>

  <!-- pyCAS nodes --> 
  <node pkg="pyCAS" type="CDB_execution_node.py" name="CDB_execution_node" output="screen">
    <param name="wait_duration" value="1" />
    <param name="timeout_duration" value="1000" />
    <param name="topological_map" value="$(find pyCAS)/domains/CDB/maps/map_info.json"
  </node>

  <node pkg="pyCAS" type="robot_status_monitor.py" name="robot_status_monitor" output="screen">
    <param name="rate" value="10" />
  </node>
  
  <node pkg="pyCAS" type="door_monitor.py" name="door_monitor" output="screen">
    <param name="rate" value="10" />
  </node>

  <!-- bringup the turtlebot -->
  <!--include file="$(find turtlebot3_fake)/launch/turtlebot3_fake.launch">
                <arg name="model" value="$(arg model)" />
  </include-->

<param name="tb3_model" value="$(arg model)"/>

  <include file="$(find turtlebot3_bringup)/launch/includes/description.launch.xml">
    <arg name="model" value="$(arg model)" />
  </include>

  <node pkg="turtlebot3_fake" type="turtlebot3_fake_node" name="turtlebot3_fake_node" output="screen" />

  <node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_state_publisher" output="screen">
    <param name="publish_frequency" type="double" value="50.0" />
  </node>

  <!-- Set up fake localization for RVIZ -->
  <node pkg="fake_localization" type="fake_localization" name="fake_localization">
    <remap from="base_pose_ground_truth" to="odom" />
</node>



  <!-- launches RVIZ -->
  <node pkg="rviz" type="rviz" name="rviz" args="-d $(find pyCAS)/rviz/default.rviz" />

  <!-- load the map -->
  <node pkg="map_server" name="map_server" type="map_server" args="$(arg map_file)"/>

  <!-- move base planner and costmaps -->
  <include file="$(find turtlebot3_navigation)/launch/move_base.launch">
        <arg name="model" value="$(arg model)" />
        <arg name="move_forward_only" value="$(arg move_forward_only)"/>
        <!--<arg name="cmd_vel_topic" value="mobile_base/commands/velocity"/>-->
        <rosparam file="$(find turtlebot3_navigation)/param/costmap_common_params.yaml" command="load" ns="global_costmap" />
        <rosparam file="$(find turtlebot3_navigation)/param/costmap_common_params.yaml" command="load" ns="local_costmap" />
        <rosparam file="$(find turtlebot3_navigation)/param/local_costmap_params.yaml" command="load" />
        <rosparam file="$(find turtlebot3_navigation)/param/global_costmap_params.yaml" command="load" />
        <rosparam file="$(find turtlebot3_navigation)/param/dwa_local_planner_params.yaml" command="load" />
        <remap from="cmd_vel" to="mobile_base/commands/velocity"/>
  </include>

</launch>


